{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from \"izitoast\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport axios from \"axios\";\n\nconst API_KEY = \"41702545-5a959d1a868233ac463ab5270\";\nconst searchForm = document.getElementById(\"search-form\");\nconst searchInput = document.getElementById(\"search-input\");\nconst galleryElement = document.getElementById(\"image-gallery\");\nconst spinner = document.getElementById(\"spinner\");\nconst loadMoreBtn = document.getElementById(\"load-more\");\n\nlet lightbox;\nlet currentPage = 1;\nlet pageSize = 40;\nlet currentQuery = \"\";\nlet isLastPage = false;\n\nsearchForm.addEventListener(\"submit\", async (event) => {\n  event.preventDefault();\n  const query = searchInput.value.trim();\n  if (query === \"\") return;\n\n  currentQuery = query;\n  currentPage = 1;\n\n  try {\n    toggleSpinner(true);\n    const response = await axios.get(`https://pixabay.com/api/?key=${API_KEY}&q=${currentQuery}&image_type=photo&orientation=horizontal&safesearch=true&page=${currentPage}&per_page=${pageSize}`);\n    \n    const data = response.data;\n    displayImages(data.hits);\n  } catch (error) {\n    showError();\n  } finally {\n    toggleSpinner(false);\n  }\n});\n\nfunction createImageElement(image) {\n  const link = document.createElement(\"a\");\n  link.href = image.largeImageURL;\n  link.setAttribute(\"data-lightbox\", \"image-gallery\");\n  link.innerHTML = `\n    <div class=\"gallery-item\">\n      <img src=\"${image.webformatURL}\" alt=\"${image.tags}\">\n      <div class=\"image-info\">\n        <div class=\"img-info-item\">\n          <p>Likes:</p>\n          <p> ${image.likes}</p>\n        </div>\n        <div class=\"img-info-item\">\n          <p>Views: </p>\n          <p>${image.views}</p>\n        </div>\n        <div class=\"img-info-item\">\n          <p>Comments: </p>\n          <p>${image.comments}</p>\n        </div>\n        <div class=\"img-info-item\">\n          <p>Downloads: </p>\n          <p>${image.downloads}</p>\n        </div>\n      </div>\n    </div>\n  `;\n  return link;\n}\n\nloadMoreBtn.addEventListener('click', async () => {\n  if (!isLastPage) {\n    currentPage += 1;\n    await fetchAndDisplayImages();\n  }\n});\n\nasync function fetchAndDisplayImages() {\n  try {\n    toggleSpinner(true);\n    const response = await axios.get(`https://pixabay.com/api/?key=${API_KEY}&q=${currentQuery}&image_type=photo&orientation=horizontal&safesearch=true&page=${currentPage}&per_page=${pageSize}`);\n    \n    const data = response.data;\n    appendImages(data.hits);\n  } catch (error) {\n    showError();\n  } finally {\n    toggleSpinner(false);\n  }\n}\n\nfunction displayImages(images) {\n  if (images.length === 0) {\n    showError();\n    return;\n  }\n\n  isLastPage = (images.length < pageSize);\n  toggleLoadMoreBtn(!isLastPage);\n  toggleSpinner(false);\n\n  galleryElement.innerHTML = \"\";\n  const imageElements = images.slice(0, pageSize).map(createImageElement);\n  galleryElement.append(...imageElements);\n\n  if (isLastPage) {\n    theEnd();\n  }\n\n  initializeLightbox();\n}\n\nfunction appendImages(images) {\n  if (images.length === 0) {\n    isLastPage = true;\n    toggleLoadMoreBtn(false);\n    toggleSpinner(false);\n    theEnd();\n    return;\n  }\n\n  const imageElements = images.map(createImageElement);\n  galleryElement.append(...imageElements);\n  initializeLightbox();\n}\n\nfunction initializeLightbox() {\n  lightbox = new SimpleLightbox('.gallery a', {\n    q: currentQuery,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: currentPage,\n    per_page: pageSize\n  });\n  lightbox.refresh();\n}\n\nfunction theEnd() {\n  iziToast.info({\n    title: 'Info',\n    message: 'Sorry, there are no more images for your request. Please try again!',\n  });\n}\n\nfunction showError() {\n  galleryElement.innerHTML = \"\";\n  iziToast.error({\n    title: 'Error',\n    message: 'Sorry, there are no images matching your search query. Please try again!',\n  });\n}\n\nconst hasImages = () => galleryElement.children.length > 0;\n\nconst toggleLoadMoreBtn = () => {\n  loadMoreBtn.classList.toggle(\"is-hidden\", isLastPage || !hasImages());\n};\n\nconst toggleSpinner = (show) => {\n  spinner.classList.toggle(\"is-hidden\", !show);\n};"],"names":["API_KEY","searchForm","searchInput","galleryElement","spinner","loadMoreBtn","lightbox","currentPage","pageSize","currentQuery","isLastPage","event","query","toggleSpinner","data","axios","displayImages","showError","createImageElement","image","link","fetchAndDisplayImages","appendImages","images","toggleLoadMoreBtn","imageElements","theEnd","initializeLightbox","SimpleLightbox","iziToast","hasImages","show"],"mappings":"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"}